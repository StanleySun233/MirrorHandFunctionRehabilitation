# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '5uipy.ui'
#
# Created by: PyQt5 UI code generator 5.15.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
import json
import sys

import requests
from PyQt5 import QtCore, QtWidgets
from PyQt5.QtCore import Qt, QDate
from PyQt5.QtGui import QPixmap
from PyQt5.QtWidgets import QFileDialog, QMessageBox

import config
import tool


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.resize(1500, 1000)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setStyleSheet('background-color:rgb(242, 249, 255)')

        self.title = QtWidgets.QLabel(self.centralwidget)
        self.title.setGeometry(QtCore.QRect(400, 10, 800, 41))
        self.title.setAlignment(Qt.AlignCenter)
        self.title.setStyleSheet('font:16pt')

        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(80, 60, 200, 40))
        self.label.setStyleSheet('font:14pt')

        self.name = QtWidgets.QLabel(self.centralwidget)
        self.name.setGeometry(QtCore.QRect(160, 60, 200, 40))
        self.name.setStyleSheet('font:14pt')

        self.label_2 = QtWidgets.QLabel(self.centralwidget)
        self.label_2.setGeometry(QtCore.QRect(280, 60, 200, 40))
        self.label_2.setStyleSheet('font:14pt')

        self.gender = QtWidgets.QLabel(self.centralwidget)
        self.gender.setGeometry(QtCore.QRect(360, 60, 200, 40))
        self.gender.setStyleSheet('font:14pt')

        self.label_3 = QtWidgets.QLabel(self.centralwidget)
        self.label_3.setGeometry(QtCore.QRect(480, 60, 200, 40))
        self.label_3.setStyleSheet('font:14pt')

        self.bornDate = QtWidgets.QDateEdit(QDate.currentDate(), self.centralwidget)#获取出生日期
        self.bornDate.setGeometry(QtCore.QRect(605, 60, 200, 40))
        self.bornDate.setStyleSheet("font:14pt")
        self.bornDate.setCalendarPopup(True)

        self.label_4 = QtWidgets.QLabel(self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(830, 60, 200, 40))
        self.label_4.setStyleSheet('font:14pt')

        self.educationLevel=QtWidgets.QLabel(self.centralwidget)#获取教育水平
        self.educationLevel.setGeometry(QtCore.QRect(970, 60, 200, 40))
        self.educationLevel.setStyleSheet('font:14pt;')

        self.table = QtWidgets.QTableWidget(self.centralwidget)
        self.table.setGeometry(QtCore.QRect(20, 120, 1460, 800))
        self.table.setStyleSheet('background:white;font:14pt')
        self.table.setColumnCount(14)
        self.table.setRowCount(33)
        self.table.verticalHeader().setVisible(False)
        self.table.horizontalHeader().setVisible(False)

        item = QtWidgets.QTableWidgetItem('视空间与执行功能')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(0, 0, item)
        self.table.setSpan(0, 0, 1, 13)
        item = QtWidgets.QTableWidgetItem('得分')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(0, 13, item)

        self.label_6=QtWidgets.QLabel(self.centralwidget)
        self.label_6.setPixmap(QPixmap('./src/fig/MoCA_1.png'))
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(1, 0, item)
        self.table.setSpan(1,0,8,3)
        self.table.setSpan(9, 0, 1, 3)
        self.table.setCellWidget(1,0,self.label_6)

        self.label_7 = QtWidgets.QLabel(self.centralwidget)
        self.label_7.setAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.label_7.setPixmap(QPixmap('D:\Pycharm\留存\MoCA_2.png'))
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(1, 3, item)
        self.table.setSpan(1, 3, 8, 3)
        self.table.setSpan(9, 3, 1,4)
        self.table.setCellWidget(1,3, self.label_7)
        item = QtWidgets.QTableWidgetItem('复\n制\n立\n方\n体')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(1, 6, item)
        self.table.setColumnWidth(6,40)
        self.table.setSpan(1, 6, 8, 1)

        self.oneScore= QtWidgets.QComboBox(self.centralwidget)
        self.oneScore.addItems(['','0','1','2','3','4','5'])
        self.oneScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(1, 13, item)
        self.table.setSpan(1, 13,9, 1)
        self.table.setCellWidget(1,13,self.oneScore)

        item = QtWidgets.QTableWidgetItem('画钟表（ 11点过10分 ）（3分）')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(1, 7, item)
        self.table.setSpan(1,7,1,6)

        self.uploadButton = QtWidgets.QPushButton(self.centralwidget)
        self.uploadButton.setStyleSheet("background-color:rgb(1, 144, 202);font:12pt;color:white")
        item = QtWidgets.QTableWidgetItem('')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(2, 7, item)
        self.table.setCellWidget(2, 7, self.uploadButton)
        self.table.setSpan(2, 7, 1, 6)
        self.table.setSpan(3, 7, 6, 6)
        item = QtWidgets.QTableWidgetItem('轮廓')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(9, 7, item)
        item = QtWidgets.QTableWidgetItem('指针')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(9, 9, item)
        item = QtWidgets.QTableWidgetItem('数字')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(9, 11, item)

        item = QtWidgets.QTableWidgetItem('命名')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(10, 0, item)
        self.table.setSpan(10, 0, 1, 14)
        self.label_8 = QtWidgets.QLabel(self.centralwidget)
        self.label_8.setAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.label_8.setPixmap(QPixmap('D:\Pycharm\留存\MoCA_3.png'))
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(11, 0, item)
        self.table.setSpan(11, 0, 4,3)
        self.table.setSpan(15, 0, 1, 3)
        self.table.setCellWidget(11,0,self.label_8)
        self.label_9 = QtWidgets.QLabel(self.centralwidget)
        self.label_9.setAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.label_9.setPixmap(QPixmap('D:\Pycharm\留存\MoCA_4.png'))
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(11, 3, item)
        self.table.setSpan(11, 3, 4, 3)
        self.table.setCellWidget(11,3,self.label_9)
        self.table.setSpan(15, 3, 1, 3)
        self.table.setCellWidget(11, 0, self.label_8)
        self.label_10 = QtWidgets.QLabel(self.centralwidget)
        self.label_10.setAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.label_10.setPixmap(QPixmap('D:\Pycharm\留存\MoCA_5.png'))
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(11, 6, item)
        self.table.setSpan(11, 6, 4, 7)
        self.table.setCellWidget(11, 6, self.label_10)
        self.table.setSpan(15, 6, 1, 7)
        self.twoScore = QtWidgets.QComboBox(self.centralwidget)
        self.twoScore.addItems(['', '0', '1', '2', '3'])
        self.twoScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(11, 13, item)
        self.table.setSpan(11, 13,5, 1)
        self.table.setCellWidget(11, 13, self.twoScore)

        item = QtWidgets.QTableWidgetItem('记忆')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 0, item)
        self.table.setSpan(16,0,3,1)
        item = QtWidgets.QTableWidgetItem('读出下列词语，然后由患者重复上述过程重复2次，5分钟后回忆。')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 1, item)
        self.table.setSpan(16, 1, 3, 3)
        item = QtWidgets.QTableWidgetItem('面孔')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 5, item)
        self.table.setSpan(16, 5, 1, 2)
        self.table.setSpan(17, 5, 1, 2)
        self.table.setSpan(18, 5, 1, 2)
        item = QtWidgets.QTableWidgetItem('天鹅绒')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 7, item)
        self.table.setSpan(16, 7, 1, 2)
        self.table.setSpan(17, 7, 1, 2)
        self.table.setSpan(18, 7, 1, 2)
        item = QtWidgets.QTableWidgetItem('教堂')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16,9, item)
        self.table.setSpan(16,9, 1, 2)
        self.table.setSpan(17, 9, 1, 2)
        self.table.setSpan(18, 9, 1, 2)
        item = QtWidgets.QTableWidgetItem('第一次')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(17, 4, item)
        item = QtWidgets.QTableWidgetItem('第二次')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(18, 4, item)
        item = QtWidgets.QTableWidgetItem('菊花')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16,11, item)
        item = QtWidgets.QTableWidgetItem('红色')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 12, item)
        item = QtWidgets.QTableWidgetItem('不计分')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(16, 13, item)
        self.table.setSpan(16, 13, 3, 1)

        item = QtWidgets.QTableWidgetItem('注意')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(19, 0, item)
        self.table.setSpan(19, 0, 2, 1)
        item = QtWidgets.QTableWidgetItem('读出下列数字，请患者重复（每秒1个）。')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(19, 1, item)
        self.table.setSpan(19, 1, 2,9)
        item = QtWidgets.QTableWidgetItem('顺背')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(19, 10, item)
        item = QtWidgets.QTableWidgetItem('21854')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(19, 12, item)
        item = QtWidgets.QTableWidgetItem('倒背')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(20, 10, item)
        item = QtWidgets.QTableWidgetItem('742')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(20, 12, item)
        self.threeScore = QtWidgets.QComboBox(self.centralwidget)
        self.threeScore.addItems(['', '0', '1', '2'])
        self.threeScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(19, 13, item)
        self.table.setSpan(19, 13, 2, 1)
        self.table.setCellWidget(19, 13, self.threeScore)

        item = QtWidgets.QTableWidgetItem('读出下列数字，每当数字出现1时，患者敲1下桌面，错误数大于或等于2不给分。')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(21, 0, item)
        self.table.setRowHeight(21,80)
        self.table.setSpan(21, 0, 1,5)
        self.table.setSpan(21, 5, 1, 4)
        item = QtWidgets.QTableWidgetItem('52139411806215194511141905112')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(21, 9, item)
        self.table.setSpan(21, 9, 1, 4)
        self.fourScore = QtWidgets.QComboBox(self.centralwidget)
        self.fourScore.addItems(['', '0', '1', '2'])
        self.fourScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(21, 13, item)
        self.table.setCellWidget(21, 13, self.fourScore)

        item = QtWidgets.QTableWidgetItem('100连续减7')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 0, item)
        self.table.setSpan(22, 0, 1, 3)
        item = QtWidgets.QTableWidgetItem('93')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 4, item)
        item = QtWidgets.QTableWidgetItem('86')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 6, item)
        item = QtWidgets.QTableWidgetItem('79')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 8, item)
        item = QtWidgets.QTableWidgetItem('72')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 10, item)
        item = QtWidgets.QTableWidgetItem('65')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 12, item)
        item = QtWidgets.QTableWidgetItem('4~5个正确给3分，2~3个正确给1分，全部错误为0分。')
        item.setTextAlignment(Qt.AlignRight|Qt.AlignVCenter)
        self.table.setItem(23, 0, item)
        self.table.setSpan(23, 0, 1, 13)
        self.fiveScore = QtWidgets.QComboBox(self.centralwidget)
        self.fiveScore.addItems(['', '0', '1', '2','3'])
        self.fiveScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(22, 13, item)
        self.table.setSpan(22, 13, 2, 1)
        self.table.setCellWidget(22, 13, self.fiveScore)

        item = QtWidgets.QTableWidgetItem('语言')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(24, 0, item)
        self.table.setSpan(24, 0,2, 1)
        item = QtWidgets.QTableWidgetItem('重复：我只知道今天张亮是来帮过忙的人。')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(24, 1, item)
        self.table.setSpan(24, 1, 1,4)
        self.table.setSpan(24, 5, 1, 2)
        item = QtWidgets.QTableWidgetItem('狗在房间的时候，猫总是躲在沙发下面')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(24, 7, item)
        self.table.setSpan(24, 7, 1, 4)
        self.table.setSpan(24, 11, 1, 2)
        self.sixScore = QtWidgets.QComboBox(self.centralwidget)
        self.sixScore.addItems(['', '0', '1', '2'])
        self.sixScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(24, 13, item)
        self.table.setCellWidget(24, 13, self.sixScore)
        item = QtWidgets.QTableWidgetItem('流畅性：在1分钟内尽可能多地说出动物的名字。')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(25, 1, item)
        self.table.setSpan(25, 1, 1, 5)
        self.table.setSpan(25, 6, 1, 2)
        self.table.setSpan(25,8, 1, 3)
        item = QtWidgets.QTableWidgetItem('(N≥11名称)')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(25, 11, item)
        self.table.setSpan(25, 11, 1, 2)
        self.sevenScore = QtWidgets.QComboBox(self.centralwidget)
        self.sevenScore.addItems(['', '0', '1'])
        self.sevenScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(25, 13, item)
        self.table.setCellWidget(25, 13, self.sevenScore)

        item = QtWidgets.QTableWidgetItem('抽象')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(26, 0, item)
        item = QtWidgets.QTableWidgetItem('词语相似性：香蕉—桔子=水果')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(26,1, item)
        self.table.setSpan(26, 1, 1, 5)
        self.table.setSpan(26, 6, 1, 2)
        item = QtWidgets.QTableWidgetItem('火车—自行车 ')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(26, 8, item)
        self.table.setSpan(26, 8, 1, 2)
        item = QtWidgets.QTableWidgetItem('手表—尺子 ')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(26, 11, item)
        self.table.setSpan(26, 11, 1, 2)
        self.eightScore = QtWidgets.QComboBox(self.centralwidget)
        self.eightScore .addItems(['', '0', '1','2'])
        self.eightScore .setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(26, 13, item)
        self.table.setCellWidget(26, 13, self.eightScore )

        item = QtWidgets.QTableWidgetItem('延迟回忆')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 0, item)
        self.table.setSpan(27, 0, 4, 1)
        item = QtWidgets.QTableWidgetItem('回忆时不能提醒')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 1, item)
        self.table.setSpan(27, 1, 2, 2)
        item = QtWidgets.QTableWidgetItem('面孔')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 3, item)
        self.table.setSpan(28, 3, 1, 3)
        self.table.setSpan(27, 3, 1, 3)
        item = QtWidgets.QTableWidgetItem('天鹅绒')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 6, item)
        item = QtWidgets.QTableWidgetItem('教堂')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27,7, item)
        self.table.setSpan(28,7, 1, 3)
        self.table.setSpan(27, 7, 1, 3)
        item = QtWidgets.QTableWidgetItem('菊花')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 10, item)
        item = QtWidgets.QTableWidgetItem('红色')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 11, item)
        item = QtWidgets.QTableWidgetItem('仅根据非提示记忆得分')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 12, item)
        self.table.setSpan(27, 12, 4, 1)
        self.nineScore = QtWidgets.QComboBox(self.centralwidget)
        self.nineScore.addItems(['', '0', '1', '2'])
        self.nineScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(27, 13, item)
        self.table.setCellWidget(27, 13, self.nineScore)
        self.table.setSpan(27, 13, 2, 1)
        item = QtWidgets.QTableWidgetItem('分类提示：')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(29, 1, item)
        self.table.setSpan(29, 1, 1, 2)
        self.table.setSpan(29, 3, 1, 3)
        self.table.setSpan(29, 7, 1, 3)
        self.tenScore = QtWidgets.QComboBox(self.centralwidget)
        self.tenScore .addItems(['', '0', '1', '2'])
        self.tenScore .setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(29, 13, item)
        self.table.setCellWidget(29, 13, self.tenScore )
        item = QtWidgets.QTableWidgetItem('多选提示：')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(30, 1, item)
        self.table.setSpan(30, 1, 1, 2)
        self.table.setSpan(30, 3, 1, 3)
        self.table.setSpan(30, 7, 1, 3)
        self.elevenScore = QtWidgets.QComboBox(self.centralwidget)
        self.elevenScore.addItems(['', '0', '1', '2'])
        self.elevenScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(30, 13, item)
        self.table.setCellWidget(30, 13, self.elevenScore)
        item = QtWidgets.QTableWidgetItem('定向')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 0, item)
        item = QtWidgets.QTableWidgetItem('日期')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 1, item)
        item = QtWidgets.QTableWidgetItem('月份')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 3, item)
        item = QtWidgets.QTableWidgetItem('年代')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 5, item)
        self.table.setColumnWidth(6,120)
        item = QtWidgets.QTableWidgetItem('星期几')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 7, item)
        item = QtWidgets.QTableWidgetItem('地点')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 9, item)
        item = QtWidgets.QTableWidgetItem('城市')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 11, item)
        self.twelveScore = QtWidgets.QComboBox(self.centralwidget)
        self.twelveScore.addItems(['', '0', '1', '2','3','4','5','6'])
        self.twelveScore.setStyleSheet('font:16pt')
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(31, 13, item)
        self.table.setCellWidget(31, 13, self.twelveScore)

        item = QtWidgets.QTableWidgetItem('总分(30)')
        item.setTextAlignment(Qt.AlignHCenter | Qt.AlignVCenter)
        self.table.setItem(32, 0, item)
        self.table.setSpan(32,1,1,12)

        self.table.setWordWrap(True)

        self.label_5 = QtWidgets.QLabel(self.centralwidget)
        self.label_5.setGeometry(QtCore.QRect(20, 940, 200, 40))
        self.label_5.setStyleSheet('font:14pt')

        self.evaluationDate = QtWidgets.QDateEdit(QDate.currentDate(), self.centralwidget)
        self.evaluationDate.setGeometry(QtCore.QRect(160, 940, 200, 40))
        self.evaluationDate.setStyleSheet("font:14pt;background:white")
        self.evaluationDate.setCalendarPopup(True)

        self.saveButton = QtWidgets.QPushButton(self.centralwidget)
        self.saveButton.setGeometry(QtCore.QRect(450, 940, 120, 40))
        self.saveButton.setStyleSheet("background-color:rgb(1, 144, 202);font:12pt;color:white")

        self.downLoadButton = QtWidgets.QPushButton(self.centralwidget)
        self.downLoadButton.setGeometry(QtCore.QRect(590, 940, 120, 40))
        self.downLoadButton.setStyleSheet("background-color:rgb(1, 144, 202);font:12pt;color:white")

        MainWindow.setCentralWidget(self.centralwidget)
        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "蒙特利尔认知评估量表(MoCA)"))
        self.title.setText(_translate("MainWindow", "蒙特利尔认知评估量表(MoCA)"))
        self.label.setText(_translate("MainWindow", "姓名:"))
        self.name.setText(_translate("MainWindow", "--"))
        self.label_2.setText(_translate("MainWindow", "性别:"))
        self.gender.setText(_translate("MainWindow", "--"))
        self.label_3.setText(_translate("MainWindow", "出生日期:"))
        self.label_4.setText(_translate("MainWindow", "教育水平:"))
        self.label_5.setText(_translate("MainWindow", "评定日期:"))
        self.uploadButton.setText(_translate("MainWindow", "上传"))
        self.saveButton.setText(_translate("MainWindow", "保存"))
        self.downLoadButton.setText(_translate("MainWindow", "导出"))


class MoCA(QtWidgets.QMainWindow, Ui_MainWindow):
    def __init__(self,patient_id):
        super(MoCA, self).__init__()
        self.setupUi(self)
        self.patient_id = patient_id

        self.patientInfo = \
            json.loads(requests.post(config.patientGetById, data={'id': self.patient_id}).content.decode('utf-8'))[
                'data']

        self.name.setText(self.patientInfo['name'])
        self.educationLevel.setText(str(self.patientInfo['education']))
        self.gender.setText(self.patientInfo['sex'])
        self.saveButton.clicked.connect(self.saveButtonClick)
        self.downLoadButton.clicked.connect(self.downLoadButtonClick)
        self.uploadButton.clicked.connect(self.uploadButtonClick)

    def saveButtonClick(self, *args):
        code_1 = self.bornDate.text()
        code_2 = self.oneScore.currentText()
        code_3 = self.twoScore.currentText()
        code_4 = self.threeScore.currentText()
        code_5 = self.fourScore.currentText()
        code_6 = self.fiveScore.currentText()
        code_7 = self.sixScore.currentText()
        code_8 = self.sevenScore.currentText()
        code_9 = self.eightScore.currentText()
        code_10 = self.nineScore.currentText()
        code_11 = self.tenScore.currentText()
        code_12 = self.elevenScore.currentText()
        code_13 = self.twelveScore.currentText()

        test_date = self.evaluationDate.text().replace('/', '-')
        sheet = {'id': tool.Tools.getTimeStamp(), 'patient_id': self.patient_id, 'code_1': code_1, 'code_2': code_2,
                 'code_3': code_3, 'code_4': code_4,'code_5': code_5,'code_6': code_6,'code_7': code_7,'code_8': code_8,'code_9': code_9,\
                 'code_10': code_10,'code_11': code_11,'code_12': code_12,'code_13': code_13,'test_date': test_date}
        res = requests.post(config.ashworthInsert, data=sheet)
        QMessageBox.information(self, "保存", '保存成功', QMessageBox.Yes, QMessageBox.Yes)
        ...

    def downLoadButtonClick(self, *args):
        self.saveButton.hide()
        self.downLoadButton.hide()
        img = self.grab()
        self.saveButton.show()
        self.downLoadButton.show()
        path = QFileDialog.getExistingDirectory()
        img.save(f"{path}/{self.name.text()}_{self.evaluationDate.text().replace('/', '-')}.png")
        ...
    def uploadButtonClick(self, *args):
        ...


if __name__ == '__main__':
    app = QtWidgets.QApplication(sys.argv)
    gui = MoCA()
    gui.show()
    sys.exit(app.exec_())