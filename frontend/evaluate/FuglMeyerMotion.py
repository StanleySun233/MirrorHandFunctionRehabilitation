# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '4.ui'
#
# Created by: PyQt5 UI code generator 5.15.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
import json
import sys

import requests
from PyQt5 import QtCore, QtWidgets
from PyQt5.QtCore import QDate


# Fugl-Meyer上肢运动功能评定
from PyQt5.QtWidgets import QFileDialog, QMessageBox

import config
import tool


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.resize(1500, 1000)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.frame_sub = QtWidgets.QFrame(self.centralwidget)
        self.frame_sub.setGeometry(QtCore.QRect(0, 0, 1500, 1000))
        self.frame_sub.setStyleSheet("background-color:rgb(242, 249, 255)")

        self.label = QtWidgets.QLabel(self.frame_sub)
        self.label.setGeometry(QtCore.QRect(460, 10, 500, 40))
        self.label.setText('简化Fugl-Meyer运动功能评分法')
        self.label.setStyleSheet("font:16pt")

        self.label_1 = QtWidgets.QLabel(self.frame_sub)
        self.label_1.setGeometry(QtCore.QRect(80, 60, 200, 40))
        self.label_1.setStyleSheet("font:14pt")

        self.name = QtWidgets.QLabel(self.frame_sub)
        self.name.setGeometry(QtCore.QRect(160, 60, 200, 40))
        self.name.setStyleSheet("font:14pt")

        self.label_2 = QtWidgets.QLabel(self.frame_sub)
        self.label_2.setGeometry(QtCore.QRect(280, 60, 200, 40))
        self.label_2.setStyleSheet("font:14pt")

        self.gender = QtWidgets.QLabel(self.frame_sub)
        self.gender.setGeometry(QtCore.QRect(360, 60, 200, 40))
        self.gender.setStyleSheet("font:14pt")

        self.label_3 = QtWidgets.QLabel(self.frame_sub)
        self.label_3.setGeometry(QtCore.QRect(480, 60, 200, 40))
        self.label_3.setStyleSheet("font:14pt")

        self.age = QtWidgets.QLabel(self.frame_sub)
        self.age.setGeometry(QtCore.QRect(560, 60, 200, 40))
        self.age.setStyleSheet("font:14pt")

        self.label_4 = QtWidgets.QLabel(self.frame_sub)
        self.label_4.setGeometry(QtCore.QRect(680, 60, 200, 40))
        self.label_4.setStyleSheet("font:14pt")

        self.hand = QtWidgets.QLabel(self.frame_sub)
        self.hand.setGeometry(QtCore.QRect(760, 60, 200, 40))
        self.hand.setStyleSheet("font:14pt")

        self.tableWidget = QtWidgets.QTableWidget(self.frame_sub)
        self.tableWidget.setGeometry(QtCore.QRect(20, 120, 1460, 700))
        self.tableWidget.setStyleSheet('background:white;font:10pt')
        self.tableWidget.setColumnCount(5)
        self.tableWidget.setRowCount(43)
        self.tableWidget.verticalHeader().setVisible(False)

        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(0, item)
        self.tableWidget.setColumnWidth(0, 455)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(1, item)
        self.tableWidget.setColumnWidth(1, 300)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(2, item)
        self.tableWidget.setColumnWidth(2, 290)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(3, item)
        self.tableWidget.setColumnWidth(3, 280)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(4, item)
        self.tableWidget.setColumnWidth(4, 100)

        item = QtWidgets.QTableWidgetItem('上肢')
        self.tableWidget.setItem(0, 0, item)
        self.tableWidget.setSpan(0, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('Ⅰ.反射（坐位）')
        self.tableWidget.setItem(1, 0, item)
        self.tableWidget.setSpan(1, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（1）肱二头肌')
        self.tableWidget.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem('不能引起反射活动')
        self.tableWidget.setItem(2, 1, item)
        item = QtWidgets.QTableWidgetItem('能引起反射活动')
        self.tableWidget.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem('（2）肱三头肌')
        self.tableWidget.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅱ.屈肌协同运动（坐位，起始位为肩内收、内旋，肘伸直，前臂旋前，指令“手心向上，屈肘，用手摸同侧耳朵，肩关节外展超过90°”）')
        self.tableWidget.setItem(4, 0, item)
        self.tableWidget.setSpan(4, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（3）肩上提')
        self.tableWidget.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem('完全不能进行')
        self.tableWidget.setItem(5, 1, item)
        item = QtWidgets.QTableWidgetItem('部分完成')
        self.tableWidget.setItem(5, 2, item)
        item = QtWidgets.QTableWidgetItem('无停顿地充分完成')
        self.tableWidget.setItem(5, 3, item)
        item = QtWidgets.QTableWidgetItem('（4）肩后缩')
        self.tableWidget.setItem(6, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(6, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(6, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(6, 3, item)
        item = QtWidgets.QTableWidgetItem('（5）肩外展≥90°')
        self.tableWidget.setItem(7, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(7, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(7, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(7, 3, item)
        item = QtWidgets.QTableWidgetItem('（6）肩外旋')
        self.tableWidget.setItem(8, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(8, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(8, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(8, 3, item)
        item = QtWidgets.QTableWidgetItem('（7）肘屈曲')
        self.tableWidget.setItem(9, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(9, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(9, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(9, 3, item)
        item = QtWidgets.QTableWidgetItem('（8）前臂旋后')
        self.tableWidget.setItem(10, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(10, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(10, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(10, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅲ.伸肌协同运动（坐位，起始位为肘屈曲、旋后，指令“内收、内旋肩关节，伸肘，前臂旋前，将胳膊伸向对侧膝盖”）')
        self.tableWidget.setItem(11, 0, item)
        self.tableWidget.setSpan(11, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（9）肩内收、内旋')
        self.tableWidget.setItem(12, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(12, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(12, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(12, 3, item)
        item = QtWidgets.QTableWidgetItem('（10）肘伸展')
        self.tableWidget.setItem(13, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(13, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(13, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(13, 3, item)
        item = QtWidgets.QTableWidgetItem('（11）前臂旋前')
        self.tableWidget.setItem(14, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(14, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(14, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(14, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅳ.伴有协同运动的活动')
        self.tableWidget.setItem(15, 0, item)
        self.tableWidget.setSpan(15, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（12）手触腰椎（坐位，手置于大腿上，指令“把手放到背后”）')
        self.tableWidget.setRowHeight(16, 80)
        self.tableWidget.setItem(16, 0, item)
        item = QtWidgets.QTableWidgetItem('没有明显活动')
        self.tableWidget.setItem(16, 1, item)
        item = QtWidgets.QTableWidgetItem('手仅可向后越过髂前上棘')
        self.tableWidget.setItem(16, 2, item)
        item = QtWidgets.QTableWidgetItem('能顺利进行')
        self.tableWidget.setItem(16, 3, item)
        item = QtWidgets.QTableWidgetItem('（13）肩关节屈曲90°，肘关节伸直（坐位，手置于大腿上，肘必须伸直，前臂可旋前或中立位）')
        self.tableWidget.setItem(17, 0, item)
        self.tableWidget.setRowHeight(17, 80)
        item = QtWidgets.QTableWidgetItem('开始时手臂立即外展或肘关节屈曲')
        self.tableWidget.setItem(17, 1, item)
        item = QtWidgets.QTableWidgetItem('在接近规定位置时肩关节外展或肘关节屈曲')
        self.tableWidget.setItem(17, 2, item)
        item = QtWidgets.QTableWidgetItem('能顺利充分完成')
        self.tableWidget.setItem(17, 3, item)
        item = QtWidgets.QTableWidgetItem('（14）肩0°，肘屈90°，前臂旋前、旋后（起始位前臂旋后）')
        self.tableWidget.setItem(18, 0, item)
        self.tableWidget.setRowHeight(18, 80)
        item = QtWidgets.QTableWidgetItem('不能屈肘或前臂不能旋前')
        self.tableWidget.setItem(18, 1, item)
        item = QtWidgets.QTableWidgetItem('肩、肘位正确，基本上能旋前、旋后')
        self.tableWidget.setItem(18, 2, item)
        item = QtWidgets.QTableWidgetItem('顺利完成')
        self.tableWidget.setItem(18, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅴ.脱离协同运动的活动')
        self.tableWidget.setItem(19, 0, item)
        self.tableWidget.setSpan(19, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（15）肩关节外展90°，肘伸直，前臂旋前（起始位为坐位，手、臂处于休息位）')
        self.tableWidget.setItem(20, 0, item)
        self.tableWidget.setRowHeight(20, 80)
        item = QtWidgets.QTableWidgetItem('开始时肘就屈曲，前臂偏离方向，不能旋前')
        self.tableWidget.setItem(20, 1, item)
        item = QtWidgets.QTableWidgetItem('可部分完成此动作或在活动时肘关节屈曲或前臂不能旋前')
        self.tableWidget.setItem(20, 2, item)
        item = QtWidgets.QTableWidgetItem('顺利完成')
        self.tableWidget.setItem(20, 3, item)
        item = QtWidgets.QTableWidgetItem('（16）肩关节自前屈90°举臂过头，肘伸直，前臂中立位（起始位为坐位，肘伸直，手休息位置于膝上）')
        self.tableWidget.setItem(21, 0, item)
        self.tableWidget.setRowHeight(21, 100)
        item = QtWidgets.QTableWidgetItem('开始时肘关节屈曲或肩关节发生外展')
        self.tableWidget.setItem(21, 1, item)
        item = QtWidgets.QTableWidgetItem('肩屈曲中途、肘关节屈曲、肩关节外展')
        self.tableWidget.setItem(21, 2, item)
        item = QtWidgets.QTableWidgetItem('顺利完成')
        self.tableWidget.setItem(21, 3, item)
        item = QtWidgets.QTableWidgetItem('（17）肩屈曲30°～90°，肘伸直，前臂旋前旋后（起始位为坐位，肘伸直，手休息位置于膝上）')
        self.tableWidget.setItem(22, 0, item)
        self.tableWidget.setRowHeight(22, 80)
        item = QtWidgets.QTableWidgetItem('前臂旋前旋后完全不能进行或肩肘位不正确')
        self.tableWidget.setItem(22, 1, item)
        item = QtWidgets.QTableWidgetItem('肩、肘位置正确，基本上能完成旋前旋后')
        self.tableWidget.setItem(22, 2, item)
        item = QtWidgets.QTableWidgetItem('顺利完成')
        self.tableWidget.setItem(22, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅵ.正常反射（坐位，如Ⅴ所得分<6分，则此项判0分）')
        self.tableWidget.setItem(23, 0, item)
        self.tableWidget.setSpan(23, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（18）检查肱二头肌、肱三头肌和指屈肌三种反射')
        self.tableWidget.setItem(24, 0, item)
        self.tableWidget.setRowHeight(24, 80)
        item = QtWidgets.QTableWidgetItem('至少2～3个反射明显亢进')
        self.tableWidget.setItem(24, 1, item)
        item = QtWidgets.QTableWidgetItem('一个反射明显亢进或至少二个反射活跃')
        self.tableWidget.setItem(24, 2, item)
        item = QtWidgets.QTableWidgetItem('活跃反射≤1个，且无反射亢进')
        self.tableWidget.setItem(24, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅶ.腕')
        self.tableWidget.setItem(25, 0, item)
        self.tableWidget.setSpan(25, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（19）稳定性，肩0°，肘屈90°时，腕背屈（坐位，手、臂处于休息位）')
        self.tableWidget.setItem(26, 0, item)
        self.tableWidget.setRowHeight(26, 80)
        item = QtWidgets.QTableWidgetItem('不能背屈腕关节达15°')
        self.tableWidget.setItem(26, 1, item)
        item = QtWidgets.QTableWidgetItem('可完成腕背屈，但不能抗拒阻力')
        self.tableWidget.setItem(26, 2, item)
        item = QtWidgets.QTableWidgetItem('施加轻微阻力仍可保持腕背屈')
        self.tableWidget.setItem(26, 3, item)
        item = QtWidgets.QTableWidgetItem('（20）肩0°，肘屈90°，腕在背屈15°～掌屈15°范围内屈伸（坐位，手、臂处于休息位）')
        self.tableWidget.setItem(27, 0, item)
        self.tableWidget.setRowHeight(27, 80)
        item = QtWidgets.QTableWidgetItem('不能随意屈伸')
        self.tableWidget.setItem(27, 1, item)
        item = QtWidgets.QTableWidgetItem('不能在全关节范围内主动活动腕关节')
        self.tableWidget.setItem(27, 2, item)
        item = QtWidgets.QTableWidgetItem('能平滑地不停顿地进行')
        self.tableWidget.setItem(27, 3, item)
        item = QtWidgets.QTableWidgetItem('（21）稳定性，肩前屈30°，肘0°，腕背屈（坐位，肘伸直，手休息位置于膝上，前臂旋前）')
        self.tableWidget.setItem(28, 0, item)
        self.tableWidget.setRowHeight(28, 80)
        item = QtWidgets.QTableWidgetItem('不能背屈腕关节达15°')
        self.tableWidget.setItem(28, 1, item)
        item = QtWidgets.QTableWidgetItem('可完成腕背屈，但不能抗拒阻力')
        self.tableWidget.setItem(28, 2, item)
        item = QtWidgets.QTableWidgetItem('施加轻微阻力仍可保持腕背屈')
        self.tableWidget.setItem(28, 3, item)
        item = QtWidgets.QTableWidgetItem('（22）腕屈伸（坐位，肘伸直，手休息位置于膝上，前臂旋前）')
        self.tableWidget.setItem(29, 0, item)
        self.tableWidget.setRowHeight(29, 80)
        item = QtWidgets.QTableWidgetItem('不能随意屈伸')
        self.tableWidget.setItem(29, 1, item)
        item = QtWidgets.QTableWidgetItem('不能在全关节范围内主动活动腕关节')
        self.tableWidget.setItem(29, 2, item)
        item = QtWidgets.QTableWidgetItem('能平滑地不停顿地进行')
        self.tableWidget.setItem(29, 3, item)
        item = QtWidgets.QTableWidgetItem('（23）腕环形运动（坐位，屈肘90°，前臂旋前）')
        self.tableWidget.setItem(30, 0, item)
        self.tableWidget.setRowHeight(30, 80)
        item = QtWidgets.QTableWidgetItem('不能进行')
        self.tableWidget.setItem(30, 1, item)
        item = QtWidgets.QTableWidgetItem('活动费力或不完全')
        self.tableWidget.setItem(30, 2, item)
        item = QtWidgets.QTableWidgetItem('正常完成')
        self.tableWidget.setItem(30, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅷ.手（坐位，手置于桌上）')
        self.tableWidget.setItem(31, 0, item)
        self.tableWidget.setSpan(31, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（24）集团屈曲（起始位为手指伸直）')
        self.tableWidget.setItem(32, 0, item)
        self.tableWidget.setRowHeight(32, 80)
        item = QtWidgets.QTableWidgetItem('不能屈曲')
        self.tableWidget.setItem(32, 1, item)
        item = QtWidgets.QTableWidgetItem('能屈曲但不充分')
        self.tableWidget.setItem(32, 2, item)
        item = QtWidgets.QTableWidgetItem('能完全主动屈曲')
        self.tableWidget.setItem(32, 3, item)
        item = QtWidgets.QTableWidgetItem('（25）集团伸展（起始位为手指屈曲）')
        self.tableWidget.setItem(33, 0, item)
        self.tableWidget.setRowHeight(33, 80)
        item = QtWidgets.QTableWidgetItem('不能伸展')
        self.tableWidget.setItem(33, 1, item)
        item = QtWidgets.QTableWidgetItem('能放松主动屈曲的手指')
        self.tableWidget.setItem(33, 2, item)
        item = QtWidgets.QTableWidgetItem('能完全主动伸展')
        self.tableWidget.setItem(33, 3, item)
        item = QtWidgets.QTableWidgetItem('（26）钩状抓握（指令“伸Ⅱ～Ⅴ腕指关节，屈近端和远端指间关节，似拎公文包”）')
        self.tableWidget.setItem(34, 0, item)
        self.tableWidget.setRowHeight(34, 80)
        item = QtWidgets.QTableWidgetItem('不能保持要求位置')
        self.tableWidget.setItem(34, 1, item)
        item = QtWidgets.QTableWidgetItem('握力微弱')
        self.tableWidget.setItem(34, 2, item)
        item = QtWidgets.QTableWidgetItem('能够抵抗相当大的阻力')
        self.tableWidget.setItem(34, 3, item)
        item = QtWidgets.QTableWidgetItem('（27）侧捏')
        self.tableWidget.setItem(35, 0, item)
        self.tableWidget.setRowHeight(35, 80)
        item = QtWidgets.QTableWidgetItem('不能进行')
        self.tableWidget.setItem(35, 1, item)
        item = QtWidgets.QTableWidgetItem('能用拇指捏住一张纸，但不能抵抗拉力')
        self.tableWidget.setItem(35, 2, item)
        item = QtWidgets.QTableWidgetItem('可牢牢捏住纸')
        self.tableWidget.setItem(35, 3, item)
        item = QtWidgets.QTableWidgetItem('（28）对捏（拇食指可挟住一根铅笔）')
        self.tableWidget.setItem(36, 0, item)
        self.tableWidget.setRowHeight(36, 80)
        item = QtWidgets.QTableWidgetItem('完全不能')
        self.tableWidget.setItem(36, 1, item)
        item = QtWidgets.QTableWidgetItem('捏力微弱')
        self.tableWidget.setItem(36, 2, item)
        item = QtWidgets.QTableWidgetItem('能抵抗相当的阻力')
        self.tableWidget.setItem(36, 3, item)
        item = QtWidgets.QTableWidgetItem('（29）圆柱状抓握')
        self.tableWidget.setItem(37, 0, item)
        item = QtWidgets.QTableWidgetItem('不能保持要求位置')
        self.tableWidget.setItem(37, 1, item)
        item = QtWidgets.QTableWidgetItem('握力微弱')
        self.tableWidget.setItem(37, 2, item)
        item = QtWidgets.QTableWidgetItem('能够抵抗相当大的阻力')
        self.tableWidget.setItem(37, 3, item)
        item = QtWidgets.QTableWidgetItem('（30）球形抓握')
        self.tableWidget.setItem(38, 0, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(38, 1, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(38, 2, item)
        item = QtWidgets.QTableWidgetItem('同上')
        self.tableWidget.setItem(38, 3, item)
        item = QtWidgets.QTableWidgetItem('Ⅸ.协调能力和速度（坐位，睁眼，指鼻试验，快速做5次）')
        self.tableWidget.setItem(39, 0, item)
        self.tableWidget.setSpan(39, 0, 1, 5)
        item = QtWidgets.QTableWidgetItem('（31）震颤')
        self.tableWidget.setItem(40, 0, item)
        item = QtWidgets.QTableWidgetItem('明显震颤')
        self.tableWidget.setItem(40, 1, item)
        item = QtWidgets.QTableWidgetItem('轻度震颤')
        self.tableWidget.setItem(40, 2, item)
        item = QtWidgets.QTableWidgetItem('无震颤')
        self.tableWidget.setItem(40, 3, item)
        item = QtWidgets.QTableWidgetItem('（32）辨距障碍')
        self.tableWidget.setItem(41, 0, item)
        item = QtWidgets.QTableWidgetItem('明显的或不规则的辨距障碍')
        self.tableWidget.setItem(41, 1, item)
        item = QtWidgets.QTableWidgetItem('轻度的或规则的辨距障碍')
        self.tableWidget.setItem(41, 2, item)
        item = QtWidgets.QTableWidgetItem('无辨距障碍')
        self.tableWidget.setItem(41, 3, item)
        item = QtWidgets.QTableWidgetItem('（33）速度')
        self.tableWidget.setItem(42, 0, item)
        item = QtWidgets.QTableWidgetItem('较健侧长6秒')
        self.tableWidget.setItem(42, 1, item)
        item = QtWidgets.QTableWidgetItem('较健侧长2～5秒')
        self.tableWidget.setItem(42, 2, item)
        item = QtWidgets.QTableWidgetItem('两侧差别<2秒')
        self.tableWidget.setItem(42, 3, item)
        self.tableWidget.setWordWrap(True)

        self.label_5 = QtWidgets.QLabel(self.frame_sub)
        self.label_5.setGeometry(QtCore.QRect(30, 840, 200, 40))
        self.label_5.setStyleSheet("font:14pt")

        self.totalscore = QtWidgets.QLabel(self.frame_sub)
        self.totalscore.setGeometry(QtCore.QRect(100, 840, 200, 40))
        self.totalscore.setStyleSheet("font:14pt")

        self.label_6 = QtWidgets.QLabel(self.frame_sub)
        self.label_6.setGeometry(QtCore.QRect(200, 840, 200, 40))
        self.label_6.setStyleSheet("font:14pt")

        self.wristScore = QtWidgets.QLineEdit(self.frame_sub)
        self.wristScore.setGeometry(QtCore.QRect(340, 840, 200, 40))
        self.wristScore.setStyleSheet("font:14pt;background:white")

        self.label_7 = QtWidgets.QLabel(self.frame_sub)
        self.label_7.setGeometry(QtCore.QRect(560, 840, 200, 40))
        self.label_7.setStyleSheet("font:14pt")

        self.handScore = QtWidgets.QLineEdit(self.frame_sub)
        self.handScore.setGeometry(QtCore.QRect(700, 840, 200, 40))
        self.handScore.setStyleSheet("font:14pt;background:white")

        self.label_8 = QtWidgets.QLabel(self.frame_sub)
        self.label_8.setGeometry(QtCore.QRect(30, 900, 200, 40))
        self.label_8.setStyleSheet("font:14pt")

        self.date = QtWidgets.QDateEdit(QDate.currentDate(), self.frame_sub)
        self.date.setGeometry(QtCore.QRect(160, 900, 200, 40))
        self.date.setStyleSheet("font:14pt;background:white")
        self.date.setCalendarPopup(True)

        self.save = QtWidgets.QPushButton(self.frame_sub)
        self.save.setGeometry(QtCore.QRect(380, 900, 120, 40))
        self.save.setStyleSheet("background-color:rgb(1, 144, 202);font:12pt;color:white")

        self.uploadButton = QtWidgets.QPushButton(self.frame_sub)
        self.uploadButton.setGeometry(QtCore.QRect(520, 900, 120, 40))
        self.uploadButton.setText('导出')
        self.uploadButton.setStyleSheet("background-color:rgb(1, 144, 202);font:12pt;color:white")

        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "Fugl-Meyer上肢运动功能评定"))
        self.save.setText(_translate("MainWindow", "保存"))
        self.label_1.setText(_translate("MainWindow", "姓名:"))
        self.name.setText(_translate("MainWindow", "--"))
        self.label_2.setText(_translate("MainWindow", "性别:"))
        self.gender.setText(_translate("MainWindow", "--"))
        self.label_3.setText(_translate("MainWindow", "年龄:"))
        self.age.setText(_translate("MainWindow", "--"))
        self.label_4.setText(_translate("MainWindow", "患手:"))
        self.hand.setText(_translate("MainWindow", "--"))
        self.label_5.setText(_translate("MainWindow", "总分:"))
        self.totalscore.setText(_translate("MainWindow", "--"))
        self.label_6.setText(_translate("MainWindow", "腕部得分:"))
        self.label_7.setText(_translate("MainWindow", "手部得分:"))
        self.label_8.setText(_translate("MainWindow", "评定日期:"))

        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "评估内容\评分"))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "0分"))
        item = self.tableWidget.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "1分"))
        item = self.tableWidget.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "2分"))
        item = self.tableWidget.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "评分"))


class FuglMeyerMotion(QtWidgets.QMainWindow, Ui_MainWindow):
    def __init__(self,patient_id):
        super(FuglMeyerMotion, self).__init__()
        self.setupUi(self)
        self.patient_id = patient_id

        self.patientInfo = \
            json.loads(requests.post(config.patientGetById, data={'id': self.patient_id}).content.decode('utf-8'))[
                'data']
        self.name.setText(self.patientInfo['name'])
        self.age.setText(str(self.patientInfo['age']))
        self.gender.setText(self.patientInfo['sex'])
        self.hand.setText(self.patientInfo['illness'])

        self.save.clicked.connect(self.saveButtonClick)
        self.uploadButton.clicked.connect(self.uploadButtonClick)

    #
    def saveButtonClick(self, *args):
        code_1 = self.totalscore.text()
        code_2 = self.handScore.text()
        code_3 = self.wristScore.text()
        test_date = self.date.text().replace('/', '-')
        sheet = {'id': tool.Tools.getTimeStamp(), 'patient_id': self.patient_id, 'code_1': code_1, 'code_2': code_2,
                 'code_3': code_3,'test_date': test_date}
        res = requests.post(config.ashworthInsert, data=sheet)
        QMessageBox.information(self, "保存", '保存成功', QMessageBox.Yes, QMessageBox.Yes)
        ...

    def uploadButtonClick(self, *args):
        self.save.hide()
        self.uploadButton.hide()
        img = self.grab()
        self.save.show()
        self.uploadButton.show()
        path = QFileDialog.getExistingDirectory()
        img.save(f"{path}/{self.name.text()}_{self.date.text().replace('/', '-')}.png")
        ...


if __name__ == '__main__':
    app = QtWidgets.QApplication(sys.argv)
    gui = FuglMeyerMotion()
    gui.show()
    sys.exit(app.exec_())
